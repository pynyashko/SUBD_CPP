# Проект базы данных на C++
Проект представляет собой реализацию клиент-серверной системы управления базой данных (СУБД) на языке C++.
Система позволяет хранить, управлять и обрабатывать записи о студентах, включая их идентификатор, ФИО,
группу, оценку и дополнительную информацию. Проект состоит из трех основных компонентов: сервер (server.cpp), 
клиент (client.cpp) и библиотека базы данных (subd.h, subd.cpp). Все компоненты поддерживают работу с кириллицей
(UTF-8 и UTF-16) и обеспечивают многопользовательскую работу с базой данных.

## Архитектура системы
Система организована по клиент-серверной архитектуре:

* __Сервер__ (server.cpp): отвечает за обработку запросов клиентов, управление экземплярами базы данных и
уведомление клиентов об изменениях.
* __Клиент__ (client.cpp): предоставляет интерфейс для взаимодействия с сервером, отправки команд и получения
результатов.
* __База данных__ (subd.h, subd.cpp): реализует функциональность хранения, выборки, редактирования и удаления
записей.

## Структура базы данных
База данных хранит записи о студентах. Каждая запись представлена структурой Student с следующими полями:

* __id__: Уникальный идентификатор (целое число).
* __name__: ФИО студента (строка до 64 символов, кириллица, формат: Фамилия Имя Отчество).
* __group__: Группа (целое положительное число).
* __rating__: Оценка (дробное число от 2.0 до 5.0 с одной цифрой после запятой).
* __info__: Дополнительная информация (строка произвольной длины).

Данные хранятся в памяти в формате UTF-16, а в файлах — в формате UTF-8.
Для оптимизации выборки используются три красно-черных дерева (std::set)
для индексации по полям name, group и rating

## Команды
Система поддерживает следующие команды для управления базой данных:
|Команда|Сигнатура|Описание|
|-------|---------|--------|
|open|<название файла>|Выбор файла базы данных|
|save||Сохранение базы данных в файл|
|select|[id=<...>, name=<...>, group=<...>, rating=<...>]|Выборка записей по критериям|
|reselect|[id=<...>, name=<...>, group=<...>, rating=<...>]|Повторная выборка среди уже выбранных записей|
|update|[name=<...>, group=<...>, rating=<...>, info=<...>]|Редактирование выбранных записей|
|remove||Удаление выбранных записей|
|add|<фио> \t <группа> \t <оценка> \t <информация>|Добавление новой записи|
|print|[id, name, group, rating, info] [range=<...>] [sort <name/group/rating>]|Вывод выбранных записей с возможностью сортировки и указания диапазона|

### Формат критериев
Критерии для команд select, reselect, update, remove задаются в следующем формате:
|Поле|Допустимые значения|
|----|-------------------|
|id|\*, конкретное число (например, 1), диапазон (например, 1-100, \*-100, 1-\*)|
|name|\*, "\*", строка с маской (например, Кузьмин\*), точное ФИО (например, "Кузьмин Иван Иванович")|
|group|\*, конкретное число (например, 101), диапазон (например, 101-103, \*-105, 104-\*)|
|rating|\*, конкретное число (например, 4), диапазон (например, 4-5, \*-4, 4-\*)|

## Клиент(client.cpp)
Клиент подключается к серверу по IP-адресу и порту, указанным в конфигурационном файле client_config.ini. Он 
предоставляет консольный интерфейс для ввода команд, отправляет их на сервер и отображает ответы.
Дополнительные команды клиента:
* __help__: Выводит справочную информацию о командах.
* __clear__: Очищает консоль.
* __reconnect__: Переподключается к серверу.
* __exit__: Завершает работу клиента.

Клиент обрабатывает уведомления от сервера об изменениях базы данных, запрашивая подтверждение перед выполнением команды, 
если данные были изменены другим пользователем.

## Сервер (server.cpp)
Сервер обрабатывает подключения клиентов, создавая для каждого клиента отдельный поток и экземпляр базы данных (Database). 
Конфигурация сервера (порт, максимальное количество клиентов) задается в файле server_config.in  
Сервер поддерживает:
* Многопользовательский доступ к файлам базы данных.
* Уведомления клиентов об изменениях в базе данных.
* Управление экземплярами базы данных для каждого клиента

## Конфигурация
* client_config.ini: Содержит server_ip (IP-адрес сервера) и port (порт для подключения).
* server_config.ini: Содержит port (порт сервера) и max_clients (максимальное количество клиентов).

## Сборка и запуск
Для сборки проекта требуется компилятор C++ с поддержкой C++17. Пример сборки:
```
g++ -std=c++17 server.cpp subd.cpp -o server
g++ -std=c++17 client.cpp subd.cpp -o client
```
Запуск сервера:
```
./server
```
Запуск клиента:
```
./client
```

## Заключение
Проект представляет собой полноценную клиент-серверную СУБД с поддержкой многопользовательского доступа и работы с кириллицей.
Код оптимиирован для быстрой выборки за счет использования красно-черных деревьев и обеспечивает базовые операции управления данными. 
Дальнейшее развитие проекта может включать улучшение безопасности, производительности и функциональности.
